{%extends "enjoy/base.html"%} 

{%block extrahead%}
	<script src="{{STATIC_URL}}js-libs/video.js" type="text/javascript" charset="utf-8"></script>
	<script src="{{STATIC_URL}}enjoy/nav.js" type="text/javascript" charset="utf-8"></script>
	<script src="{{STATIC_URL}}enjoy/card.js"></script>
	<link rel="stylesheet" href="{{STATIC_URL}}js-libs/video-js.css" type="text/css" media="screen" title="Video JS" charset="utf-8">
	<link rel="stylesheet" href="{{STATIC_URL}}enjoy/card.css" type="text/css" media="screen"  charset="utf-8">
	<script type="text/javascript" charset="utf-8">
		VideoJS.setupAllWhenReady();
	</script>	

	<style>
	{{card.guide.theme.text}}
	</style>
{%endblock%}


<body>

{%block header%}
		<a href="{{card.guide.get_absolute_url}}">Back to {{card.guide.title|title}} Index</a>
{%endblock%}

{% block content %} 


{%load markup%}

<div id="card_wrap" class="box">
	<div class="card" data-id="{{card.slug}}">
		{%if card.title%}
			<h1>{{card.title}} </h1>
		{%endif%}
	    
		{# ********************************** #}	
		{# ***       PRIMARY MEDIA        ****#}
		{# ********************************** #}
		{%if primary_media.type == "image"%}
			{# width:{{primary_media.file.photo.image.width}} #} {# <br>height:{{primary_media.file.photo.image.height}} #}
			{# <img src="{{primary_media.file}}" class="primary_media"> #}
			<img src="{{primary_media.file.photo.get_large_url}}" class="primary_media">
		{%endif%}
		
	    {%if primary_media.type == "video"%}
	    <div id="content">
        <div class="video-js-box primary_media">
				<video id="video" 
				class="video-js "
				width="800" 
				height="600" 
				{# poster=""#}
				{%if primary_media.autoplay%}autoplay{%endif%}
				preload = "auto">
				<source src="{{primary_media.file}}" type="video/mp4; codecs='avc1.42E01E, mp4a.40.2'" />
				Browser doesn't support HTML5 video.
				<object class="vjs-flash-fallback" width="640" height="264" type="application/x-shockwave-flash"
      			  data="http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf">
     			  <param name="movie" value="http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf" />
        		  <param name="allowfullscreen" value="true" />
        		  <param name="flashvars" value='config={"playlist":[{"url": "{{primary_media.file}}","autoPlay":false,"autoBuffering":true}]}' />
      			</object>
				</video>				
		</div>
		</div>
	    {%endif%}		
	
	    {%if primary_media.type == "audio"%}
	    	<div class="audio primary_media">
	    		<audio src="{{primary_media.file}}" 
	    		controls 
	    		preload="auto" 
	    		autobuffer>
	    		</audio>		  
			</div>
	    {%endif%}
	
	
	{# ********************************** #}	
	{# ***           THUMBS           ****#}
	{# ********************************** #}
	<div class="other_card_media">
		{%if media_elements|length > 1 %}	
		{%for el in media_elements%}		
		
			{%if el.type == "video"%}
				<a href="{{el.file}}" class="thumb video" data-media_type="video">
					<img src="{{el.file.thumb_url}}"/>
				</a>
	    	{%endif%}		
   

		    {%if el.type == "audio"%}
		    	<a class="thumb audio" href="{{el.file}}" data-media_type="audio">
			    	<img 
			    	src="{{el.file.thumb_url}}" >

		    	</a>
		    {%endif%}

			{%if el.type == "image"%}
				
			<a href="{{el.file}}" class="thumb image" data-media_type="image">
				<img src="{{el.file.thumb_url}}">
			</a>
		    {%endif%}
				    
		{%endfor%}
		{%endif%} {# if greater than 1 #}

		</div> {# end  .other_card_media#}
					
			
		{%if card.text%}
		<div class="card_text">
			{{card.text|markdown}}
		</div>
		{%endif%}
			
		<div class="card_interactive_elements">	
			{%for el in input_elements%}
				<div class="interactive_element">
					{%include el.el_template%}
				</div>
			{%endfor%}
		</div>

		{%if not card.is_floating_card%}
		<div class="prev_and_next">
			{%if prev_card%}<div class="interactive_element" style="float:left"><a href="{{prev_card.get_absolute_url}}" class="goto">← Previous</a></div>{%endif%}
			
			{%if next_card%}<div class="interactive_element"><a href="{{next_card.get_absolute_url}}" class="goto">Next →</a></div>{%endif%}
		
		</div>
		{%endif%}
			
			</div> {# end .card #}
			
</div> {# end #card_wrap #}

{%if primary_media.type == "video" or primary_media.type == "audio" %}
<br>
<div id="footer">
  <div id="tag">Media Controls</div>
  <div id="bottom_nav">
    <div class="button" id="play">Play</div>
    <div class="button" id="pause">Pause</div>
    <div class="button" id="vUp">Vol Up</div>
    <div class="button" id="vDown">Vol Down</div>
    <div class="button" id="mute"><input type="checkbox" id="mute_check"/>  Mute</div> 
  </div>
</div>
{%endif%}



</body>

{% endblock %}
