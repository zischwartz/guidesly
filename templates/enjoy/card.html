{%extends "enjoy/base.html"%} 

{%block extrahead%}      
                     
   <!--Core CSS Files for Enjoy -->  
                                               
   <!--<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}enjoy/boilerplate.css?v=1">--> 
   	<link rel="stylesheet" href="{{STATIC_URL}}js-libs/video-js.css" type="text/css" media="screen" title="Video JS" charset="utf-8">
	<link rel="stylesheet" href="{{STATIC_URL}}enjoy/card.css" type="text/css" media="screen"  charset="utf-8">     
	<link rel="stylesheet" href="{{STATIC_URL}}js-libs/mediaplayer/mediaelementplayer.css"/>    
   


   
	   <script src="{{STATIC_URL}}js-libs/mediaplayer/jquery.js"></script>
	   <script src="{{STATIC_URL}}js-libs/mediaplayer/mediaelement-and-player.min.js"></script>  
	   <script src="{{STATIC_URL}}js-libs/mediaplayer/mediaelement-and-player.js"></script> 
	    
	  
	  
           
	    <script src="{{STATIC_URL}}js-libs/video.js" type="text/javascript" charset="utf-8"></script>
	    <script src="{{STATIC_URL}}enjoy/nav.js" type="text/javascript" charset="utf-8"></script> 
		<script src="{{STATIC_URL}}enjoy/card.js"></script>        
		<script src="{{STATIC_URL}}js-libs/jquery-1.6.2.min.js" type="text/javascript"></script>           
		<script src="{{STATIC_URL}}js-libs/jquery-ui-1.8.13.custom.min.js" type="text/javascript"></script>     
		<script src="{{STATIC_URL}}enjoy/flash/flowplayer/example/flowplayer-3.2.6.min.js"</script>     
		<script src="{{STATIC_URL}}enjoy/flash/flowplayer/flowplayer.controls.js"</script>
	   
		

			    
	<script type="text/javascript" charset="utf-8">     
	//add videoJS to all video tags on the page when DOM is ready
				
	VideoJS.setupAllWhenReady();        
	$('audio,video').mediaelementplayer();
		 		 
	</script>	
	         
	<style>
	{{card.guide.theme.text}}
	</style>    
{%endblock%}

<body>   

{%block header%}
      <a href="{{card.guide.get_absolute_url}}">Back to {{card.guide.title|title}} Index</a>  
{%endblock%}


{% block content %} 


{%load markup%}

<div id="card_wrap" class="box">            
	<div class="card
		{%if not card.title%} notitle {%endif%}
		{%if card.primary_media%} hasprimarymedia{%endif%}
		{%if not card.primary_media%} noprimarymedia{%endif%} 
		{%if media_elements|length > 1 %} hasthumbs {%endif%}      
		{%if images|length > 1 %} hasthumbs {%endif%}  
		{%if not card.text%} notext {%endif%}
		{%if card.input_elements%} hasinputs{%endif%}
		{%if not card.is_floating_card%} hasprevandnext {%endif%}
	" data-id="{{card.slug}}">
		
		{%if card.title%}
			<h1>{{card.title}} </h1>
		{%endif%}        
		
	   		{# ********************************** #}	
			{# ***       PRIMARY MEDIA        ****#}
			{# ********************************** #}   
			
			<div class= "primary_media">
	 
			{%if primary_media.type == "image"%}  
						<img src="{{primary_media.file.photo.get_large_url}}" class="primary_media">
			{%endif%}      
			

			   {%if primary_media.type == "video"%} 
			
				       <div id = "content">  
					   <video src="{{primary_media.file}}" width="800" height="600"></video> 
					   </div>      
					 
				       <script>
					   // using jQuery
					   var player = $('video,audio').mediaelementplayer();
						</script>>
					  
						<!--
						<div class="video-js-box primary_media">

								     <video id="video" 
									 class="video-js"

									 class="video-js "
									 width="600" 
									 height="440" 
									 {# poster=""  #}
									 {%if primary_media.autoplay%}autoplay{%endif%}
									preload = "auto">
										<source src="{{primary_media.file}}" type= 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"' class="primary_media" />
									   <!-- <source src="{{primary_media.file}}" type= 'video/webm; codecs="vp8, vorbis"' />
										<source src="{{primary_media.file}}" type='video/ogg; codecs="theora,vorbis"'/>     
									     Browser doesn't support HTML5 video.-->     
									   <!-- <object class="vjs-flash-fallback" width="640" height="400" type="application/x-shockwave-flash"
										      			  data="{{STATIC_URL}}enjoy/flash/flowplayer/flowplayer-3.2.7.swf">
										     			  <param name="movie" value="{{STATIC_URL}}enjoy/flash/flowplayer/flowplayer-3.2.7.swf" />
										        		  <param name="allowfullscreen" value="true" />
										        		  <param name="flashvars" value='config={"clip":{"url": "{{primary_media.file}}","autoPlay":false,"autoBuffering":true}}' />
										 </object>                     
										
										

											</video>	       
								  </div>-->
				  
					   	       
			    {%endif%}	   
			

			    {%if primary_media.type == "audio"%} 
			
			  	   
			       <div class="audio primary_media">                                 
		   
			       <audio id="aplayer" type="audio/mp3" controls="controls">   
						<source src="{{primary_media.file}}">
							    
				    </audio>       
				</div>
				
				
			   <script>    
			
			   var player = $('video,audio').mediaelementplayer(/* Options */);  
			
			  
                        

		 
		      /*
				
			     	if (document.createElement('audio').canPlayType) {
				    if (!document.createElement('audio').canPlayType('audio/mpeg')) {
               
				$f("fallback", "http://releases.flowplayer.org/swf/flowplayer-3.2.7.swf", {   
					// fullscreen button not needed here
					plugins: {
						controls: {
							fullscreen: false,
							height: 30,
							autoHide: false
						}
					},

					clip: {
						autoPlay: false,

						// optional: when playback starts close the first audio playback
						onBeforeBegin: function() {
							$f("player").close();
						}
					}

				});
				}
				}   
				
				   */

			     </script>     
				
			    {%endif%}   
			
		               
		   


			{# ********************************** #}	
			{# ***           THUMBS           ****#}
			{# ********************************** #}   
			
			
		 <!--   <div class="other_card_media">
			    {%if audio%}
			    	{# <a class="thumb audio" href="{{el.file}}" data-media_type="audio"> #}
				    	{# <img src="{{audio.file.thumb_url}}" > #}
				    	<div class="audio">
					    	<audio 
					    	src="{{audio.file}}"  
							{%if audio.autoplay %}autoplay{%endif%}
					    	controls="controls" >
							</audio>
							<br>{{audio.title}}
					</div>
			    	{# </a> #}
			    {%endif%}

				{%if images|length > 0 %}	
				{%for el in images%}		
					<a href="{{el.file}}" class="thumb image" data-media_type="image">
						<img src="{{el.file.thumb_url}}">     
					</a>    
				{%endfor%}
				{%endif%} {# if greater than 1 #}

				</div> {# end  .other_card_media#}   -->
				
		    <div class="other_card_media">   
			 {%if media_elements|length > 1%}
					{%for el in media_elements%}
						{%if el.type == "video" %}
							<a href="{{el.file}}" class="thumb video" data-media_type="video">
								<img src="{{el.file.thumb_url}}">
							</a>
						 {%endif%}
						
						{%if el.type == "image" %}
							<a href="{{el.file}}" class="thumb image" data-media_type="image">
								<img src ="{{el.file.thumb_url}}">
							 </a>
						{%endif%} 
						
						{%if el.type == "audio" %}
							<a href="{{el.file}}" class="thumb audio" data-media_type="audio">
								<img src ="{{el.file.thumb_url}}"> 
						   </a>
						{%endif%}
					{%endfor%}
				{%endif%}    

		   </div> {# end  .other_card_media#}   


				{%if card.text%}
				<div class="card_text">
					{{card.text|markdown}}
				</div>
				{%endif%}

				<div class="input_wrapper">	
					{%for el in input_elements%}
						<div class="input_element nonlinear">
							{%include el.el_template%}
						</div>
					{%endfor%}		
				</div>   
				
				</div>
                       
            
				{%if not card.is_floating_card%}
				<div class="prev_and_next">
					{%if prev_card%}<div class="input_element prev"><a href="{{prev_card.get_absolute_url}}" class="goto"> ⬅ Previous</a></div>{%endif%}

					{%if next_card%}<div class="input_element next"><a href="{{next_card.get_absolute_url}}" class="goto">Next ➡</a></div>{%endif%}
				</div>
				{%endif%}



					</div> {# end .card #}

		</div> {# end #card_wrap #}     
		
		
	
		{%if primary_media.type == "video" or primary_media.type == "audio" %}
		<br>
		<div id="footer">
		  <div id="tag">Media Controls</div>
		  <div id="bottom_nav">
		    <div class="button" id="play">Play</div>
		    <div class="button" id="pause">Pause</div>
		    <div class="button" id="vUp">Vol Up</div>
		    <div class="button" id="vDown">Vol Down</div>
		    <div class="button" id="mute"><input type="checkbox" id="mute_check"/>  Mute</div> 
		  </div>
		</div>
		{%endif%}  
		

{%endblock%}
	
