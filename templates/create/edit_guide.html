{%extends "base.html" %}

{%block extrahead%}
		<link rel="stylesheet" media="all" href="{{STATIC_URL}}create/guide.css"/>

	<script src="{{STATIC_URL}}create/guide.js"></script>
	<script type="text/javascript">
		var guide_json = '{{guide_json|safe|escapejs}}'; 
	</script>

{%endblock%}

{%block header%}
	<div class="headerTitle"> Edit Guide</div>
{%endblock%}

{% block content %} 

<h1>{{guide.title}}</h1>
<h2>{{guide.description}}</h2>
<br><br>

<h2>Cards</h2> 
{%if guide.is_linear %}
	<div class="row">
		<div class="normal_card_container connectedSortable span10 columns" data-bind="template: {name: 'smallCardTemplate',
						  						foreach: VM.normal_cards, templateOptions: { parentList: VM.normal_cards}},
						 						sortableList: VM.normal_cards">
				<a  href="{% url BuildCard gslug=guide.slug %}"class="uibutton"/>Add a New Card</a>			
		</div>

		<div class="floating_card_container span6 columns" >
			<h2>Side Cards</h2> 
			<p>These cards are outside the normal flow of your guide. Mostly, this means they don't have previous and next buttons, and you have to create buttons to get your users to these cards. </p>
			<div data-bind="template: {name: 'smallCardTemplate',
						  						foreach: VM.floating_cards, templateOptions: { parentList: VM.floating_cards}},
												sortableList: VM.floating_cards" class="connectedSortable ">
			</div>
		</div>
		<a  href="{% url BuildFloatingCard gslug=guide.slug %}"class="uibutton"/>Add a New Side Card</a>

	</div> {# /row #}
{%else%}
	<div class="row">
		<div class="floating_card_container span16 columns" >

			<div data-bind="template: {name: 'smallCardTemplate',
						  						foreach: VM.floating_cards, templateOptions: { parentList: VM.floating_cards}},
												sortableList: VM.floating_cards" class="connectedSortable ">
			</div>
		</div>
	</div>
	<a  href="{% url BuildFloatingCard gslug=guide.slug %}"class="uibutton"/>Add a New Card</a>
{%endif%}




{%load verbatim_templatetag%} 


{%verbatim%}
	<script id='smallCardTemplate' type='text/html'>
	<div class="smallcardWrapper" id="${id}" data-bind="sortableItem: { item: $data, parentList: $item.parentList }"> 
		<div class="cardNumber"><span data-bind="text: card_number"></span> </div>
		<div class="smallcard">
			<span data-bind="text: title() ? title: 'Untitled Card '"></span>
			{{if primary_media }}<br><img src="${primary_media.file.thumb_url}">{{/if}} 
		</div>
		<div class="controls">
			<a href="${edit_url}">Edit</a>
			<a href="${absolute_url}">Preview</a>
			<a href="#" class="delete_link">Delete</a>
			<a href="#" class="delete_link_real" data-bind="click: deleteCard">Sure?</a>
		</div>
	</div>
	</script>
{%endverbatim%}

<form action="" method="post">
{% csrf_token %}
<table>	{{form.as_table}}</table>
<input type="submit" value="Edit guide" />
</form>
{% endblock %} {# end content #}

{# {%block sidebar%} #}




	
{# {%endblock %} #}
